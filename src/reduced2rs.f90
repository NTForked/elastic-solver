SUBROUTINE disp2rs(val, U, G) 
IMPLICIT NONE 
REAL(KIND=8) val(9, 1) 
REAL(KIND=8) U(3, 4) 
REAL(KIND=8) G(3, 3) 
REAL(KIND=8)  tt1 
REAL(KIND=8)  tt2 
REAL(KIND=8)  tt3 
REAL(KIND=8)  tt4 
REAL(KIND=8)  tt5 
REAL(KIND=8)  tt6 
REAL(KIND=8)  tt7 
REAL(KIND=8)  tt8 
REAL(KIND=8)  tt9 
REAL(KIND=8)  tt10 
REAL(KIND=8)  tt11 
REAL(KIND=8)  tt12 
REAL(KIND=8)  tt13 
REAL(KIND=8)  tt14 
REAL(KIND=8)  tt15 
REAL(KIND=8)  tt16 
REAL(KIND=8)  tt17 
REAL(KIND=8)  tt18 
REAL(KIND=8)  tt19 
REAL(KIND=8)  tt20 
REAL(KIND=8)  tt21 
tt1 = -U(1,1)
tt2 = U(1,2)+tt1
tt3 = U(1,3)+tt1
tt4 = -U(2,1)
tt5 = U(2,2)+tt4
tt6 = G(1,1)*tt5
tt7 = U(2,3)+tt4
tt8 = G(2,1)*tt7
tt9 = U(2,4)+tt4
tt10 = tt9*G(3,1)
tt11 = U(1,4)+tt1
tt12 = -U(3,1)
tt13 = U(3,2)+tt12
tt14 = G(1,1)*tt13
tt15 = U(3,3)+tt12
tt16 = G(2,1)*tt15
tt17 = U(3,4)+tt12
tt18 = G(3,1)*tt17
tt19 = G(1,2)*tt13
tt20 = G(2,2)*tt15
tt21 = G(3,2)*tt17
val(1,1) = 0.5*(-tt11*G(3,2)+tt10+tt8+tt6-tt3*G(2,2)-G(1,2)*tt2)
val(2,1) = 0.5*(tt18+tt16-tt11*G(3,3)+tt14-tt3*G(2,3)-tt2*G(1,3))&
&
val(3,1) = 0.5*(tt21+tt20-tt9*G(3,3)+tt19-G(2,3)*tt7-G(1,3)*tt5)
val(4,1) = 0.5*(2*tt11*G(3,1)+2*tt3*G(2,1)+2*G(1,1)*tt2)
val(5,1) = 0.5*(tt11*G(3,2)+tt10+tt8+tt6+tt3*G(2,2)+G(1,2)*tt2)
val(6,1) = 0.5*(tt18+tt16+tt11*G(3,3)+tt14+tt3*G(2,3)+tt2*G(1,3))&
&
val(7,1) = 0.5*(2*tt9*G(3,2)+2*G(2,2)*tt7+2*G(1,2)*tt5)
val(8,1) = 0.5*(tt21+tt20+tt9*G(3,3)+tt19+G(2,3)*tt7+G(1,3)*tt5)
val(9,1) = 0.5*(2*G(3,3)*tt17+2*G(2,3)*tt15+2*G(1,3)*tt13)
END 
SUBROUTINE disp2rs_jac(jac, U, G) 
IMPLICIT NONE 
REAL(KIND=8) jac(9, 12) 
REAL(KIND=8) U(3, 4) 
REAL(KIND=8) G(3, 3) 
REAL(KIND=8)  tt1 
REAL(KIND=8)  tt2 
REAL(KIND=8)  tt3 
REAL(KIND=8)  tt4 
REAL(KIND=8)  tt5 
REAL(KIND=8)  tt6 
REAL(KIND=8)  tt7 
REAL(KIND=8)  tt8 
REAL(KIND=8)  tt9 
REAL(KIND=8)  tt10 
REAL(KIND=8)  tt11 
REAL(KIND=8)  tt12 
REAL(KIND=8)  tt13 
REAL(KIND=8)  tt14 
REAL(KIND=8)  tt15 
REAL(KIND=8)  tt16 
tt1 = 0.5*(-G(3,1)-G(2,1)-G(1,1))
tt2 = 0.5*G(1,1)
tt3 = 0.5*G(2,1)
tt4 = 0.5*G(3,1)
tt5 = 0.5*(G(3,3)+G(2,3)+G(1,3))
tt6 = -0.5*G(1,3)
tt7 = -0.5*G(2,3)
tt8 = -0.5*G(3,3)
tt9 = 0.5*(-G(3,2)-G(2,2)-G(1,2))
tt10 = 0.5*G(1,2)
tt11 = 0.5*G(2,2)
tt12 = 0.5*G(3,2)
tt13 = 0.5*(-G(3,3)-G(2,3)-G(1,3))
tt14 = 0.5*G(1,3)
tt15 = 0.5*G(2,3)
tt16 = 0.5*G(3,3)
jac(1,1) = 0.5*(G(3,2)+G(2,2)+G(1,2))
jac(1,2) = tt1
jac(1,3) = 0
jac(1,4) = -0.5*G(1,2)
jac(1,5) = tt2
jac(1,6) = 0
jac(1,7) = -0.5*G(2,2)
jac(1,8) = tt3
jac(1,9) = 0
jac(1,10) = -0.5*G(3,2)
jac(1,11) = tt4
jac(1,12) = 0
jac(2,1) = tt5
jac(2,2) = 0
jac(2,3) = tt1
jac(2,4) = tt6
jac(2,5) = 0
jac(2,6) = tt2
jac(2,7) = tt7
jac(2,8) = 0
jac(2,9) = tt3
jac(2,10) = tt8
jac(2,11) = 0
jac(2,12) = tt4
jac(3,1) = 0
jac(3,2) = tt5
jac(3,3) = tt9
jac(3,4) = 0
jac(3,5) = tt6
jac(3,6) = tt10
jac(3,7) = 0
jac(3,8) = tt7
jac(3,9) = tt11
jac(3,10) = 0
jac(3,11) = tt8
jac(3,12) = tt12
jac(4,1) = 0.5*(-2*G(3,1)-2*G(2,1)-2*G(1,1))
jac(4,2) = 0
jac(4,3) = 0
jac(4,4) = 1.0*G(1,1)
jac(4,5) = 0
jac(4,6) = 0
jac(4,7) = 1.0*G(2,1)
jac(4,8) = 0
jac(4,9) = 0
jac(4,10) = 1.0*G(3,1)
jac(4,11) = 0
jac(4,12) = 0
jac(5,1) = tt9
jac(5,2) = tt1
jac(5,3) = 0
jac(5,4) = tt10
jac(5,5) = tt2
jac(5,6) = 0
jac(5,7) = tt11
jac(5,8) = tt3
jac(5,9) = 0
jac(5,10) = tt12
jac(5,11) = tt4
jac(5,12) = 0
jac(6,1) = tt13
jac(6,2) = 0
jac(6,3) = tt1
jac(6,4) = tt14
jac(6,5) = 0
jac(6,6) = tt2
jac(6,7) = tt15
jac(6,8) = 0
jac(6,9) = tt3
jac(6,10) = tt16
jac(6,11) = 0
jac(6,12) = tt4
jac(7,1) = 0
jac(7,2) = 0.5*(-2*G(3,2)-2*G(2,2)-2*G(1,2))
jac(7,3) = 0
jac(7,4) = 0
jac(7,5) = 1.0*G(1,2)
jac(7,6) = 0
jac(7,7) = 0
jac(7,8) = 1.0*G(2,2)
jac(7,9) = 0
jac(7,10) = 0
jac(7,11) = 1.0*G(3,2)
jac(7,12) = 0
jac(8,1) = 0
jac(8,2) = tt13
jac(8,3) = tt9
jac(8,4) = 0
jac(8,5) = tt14
jac(8,6) = tt10
jac(8,7) = 0
jac(8,8) = tt15
jac(8,9) = tt11
jac(8,10) = 0
jac(8,11) = tt16
jac(8,12) = tt12
jac(9,1) = 0
jac(9,2) = 0
jac(9,3) = 0.5*(-2*G(3,3)-2*G(2,3)-2*G(1,3))
jac(9,4) = 0
jac(9,5) = 0
jac(9,6) = 1.0*G(1,3)
jac(9,7) = 0
jac(9,8) = 0
jac(9,9) = 1.0*G(2,3)
jac(9,10) = 0
jac(9,11) = 0
jac(9,12) = 1.0*G(3,3)
END